<div class="container mt-4">
  <div *ngIf="isLoading" class="text-center">
    <strong>Carregando seus dados...</strong>
  </div>


  <!-- O container principal só aparece quando os dados chegam e o loading termina -->
  <div *ngIf="!isLoading && dadosConta as conta">
    <h1>Minha Conta</h1>
    <p>Olá, {{ conta.nome }}!</p>
    <hr>

    <div class="row">
      <!-- Card: Dados Pessoais -->
      <div class="col-md-12 mb-4">
        <div class="card">
          <div class="card-header">
            <h4>Dados Pessoais</h4>
          </div>
          <div class="card-body">
            <p><strong>Nome:</strong> {{ conta.nome }}</p>
            <p><strong>Email:</strong> {{ conta.email }}</p>
            <p><strong>CPF:</strong> {{ conta.cpf }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Card: Minha Assinatura -->
      <div class="col-md-6 mb-4">
        <div class="card">
          <div class="card-header">
            <h4>Minha Assinatura</h4>
          </div>
          <div class="card-body">
            <div *ngIf="conta.assinaturaAtiva; else semAssinatura">
              <p><strong>Plano:</strong> {{ conta.assinaturaAtiva.plano?.descricao || 'Plano não informado' }}</p>
              <p><strong>Data de Início:</strong> {{ conta.assinaturaAtiva.dataInicio | date: 'dd/MM/yyyy' }}</p>
              <a href="#" class="btn btn-success">Gerenciar Assinatura</a>
            </div>

            <ng-template #semAssinatura>
              <div class="alert alert-info text-center">
                Você ainda não possui uma assinatura ativa.
                <br>
                <a routerLink="/planos" class="alert-link">Que tal conhecer nossos planos?</a>
              </div>
            </ng-template>

            <div class="text-center">
              <a routerLink="/minha-conta/assinaturas" class="btn btn-secondary">Ver Histórico</a>
            </div>

          </div>
        </div>
      </div>

      <!-- Card: Minhas Preferências-->
      <div class="col-md-6 mb-4">
        <div class="card h-100">
          <div class="card-header">
            <h4>Minhas Preferências</h4>
          </div>
          <div class="card-body d-flex flex-column">
            <div *ngIf="conta.perfisDeGenero.length > 0; else semPreferencias">
              <p>Seus gêneros favoritos:</p>
              <div>
                <span *ngFor="let p of conta.perfisDeGenero" class="badge bg-info me-2 fs-6">
                  {{ p.descricaoDoGenero }}
                </span>
              </div>
            </div>

            <ng-template #semPreferencias>
              <div class="alert alert-light text-center">
                Você ainda não definiu suas preferências de gêneros.
              </div>
            </ng-template>

            <!-- Botão de redirecionamento para a página de perfil -->
            <div class="mt-auto text-center">
              <a routerLink="/perfil" class="btn btn-primary">Editar Preferências</a>
            </div>
          </div>
        </div>
      </div>
    </div>



  </div>
</div>
